{"version":3,"file":"toTextgenExtendedBody.js","sourceRoot":"","sources":["../../src/textgen/toTextgenExtendedBody.ts"],"names":[],"mappings":"AAAA,OAAO,EAIL,sBAAsB,EACtB,QAAQ,GACT,MAAM,mCAAmC,CAAC;AAE3C,MAAM,CAAC,MAAM,qBAAqB,GAAG,CACnC,OAA4D,EAC5D,EAAE;IACF,OAAO,CAAC,GAAG,CAAC,gCAAgC,EAAE,OAAO,CAAC,CAAC;IACvD,MAAM,EAAE,IAAI,EAAE,OAAO,GAAG,EAAE,EAAE,GAAG,OAAO,CAAC;IACvC,MAAM,EAAE,WAAW,GAAG,SAAS,EAAE,YAAY,GAAG,QAAQ,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;IAE3E,MAAM,YAAY,GAAuD;QACvE,UAAU,EAAE,GAAG;QACf,MAAM,EACJ,WAAW,KAAK,KAAK;YACnB,CAAC,CAAC,QAAQ,CAAC,wBAAwB,CAAC;gBAChC,QAAQ,EAAE,IAAI,CAAC,QAAQ,IAAI,EAAE;gBAC7B,eAAe,EAAE,sBAAsB,CAAC,YAAY,CAAC;aACtD,CAAC;YACJ,CAAC,CAAC,SAAS;QACf,GAAG,IAAI;QACP,QAAQ,EAAE,WAAW,KAAK,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ;QAC3D,IAAI;KACL,CAAC;IACF,OAAO,YAAY,CAAC;AACtB,CAAC,CAAC","sourcesContent":["import {\n  type TextgenConnectionMap,\n  type OobaboogaTextgenRequest,\n  type OpenRouterTextgenRequest,\n  TEXTGEN_CHAT_TEMPLATES,\n  Textgens,\n} from \"@mjt-services/textgen-common-2025\";\n\nexport const toTextgenExtendedBody = (\n  request: TextgenConnectionMap[\"textgen.generate\"][\"request\"]\n) => {\n  console.log(\"toTextgenExtendedBody: request\", request);\n  const { body, options = {} } = request;\n  const { promptStyle = \"message\", templateType = \"chatML\", stop } = options;\n\n  const extendedBody: OobaboogaTextgenRequest & OpenRouterTextgenRequest = {\n    max_tokens: 256,\n    prompt:\n      promptStyle === \"raw\"\n        ? Textgens.chatMessagesToPromptText({\n            messages: body.messages ?? [],\n            messageTemplate: TEXTGEN_CHAT_TEMPLATES[templateType],\n          })\n        : undefined,\n    ...body,\n    messages: promptStyle === \"raw\" ? undefined : body.messages,\n    stop,\n  };\n  return extendedBody;\n};\n"]}